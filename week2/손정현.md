# ì œë„¤ë ˆì´í„°ì™€ ì´í„°ë ˆì´í„°

## ì œë„¤ë ˆì´í„°ì™€ ì´í„°ë¦¬ì—í„°

### ì œë„¤ë ˆì´í„°ë€?

ì œë„¤ë ˆì´í„°ëŠ” `ì´í„°ë ˆì´í„°ì´ì ì´í„°ëŸ¬ë¸”ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜` ë¥¼ ë§í•©ë‹ˆë‹¤.

ì œë„¤ë ˆì´í„°ë¥¼ í™œìš©í•˜ë©´ ì‰½ê²Œ ì´í„°ë ˆì´í„°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì—¬ê¸°ì„œ ì´í„°ë ˆì´í„°ëŠ” `Symbol.iterator` ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— 

ì´í„°ë ˆì´í„°ì´ì ì´í„°ëŸ¬ë¸” í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ ì œë„¤ë ˆì´í„°ëŠ” `well formed iterator` ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì¸ ê²ƒì…ë‹ˆë‹¤.

```jsx
function *gen() {
  yield 1;
  yield 2;
  yield 3;
	return 100; // ë§ˆì§€ë§‰ done: true ì—ì„œ ë°˜í™˜ë˜ëŠ” ê°’
}

const iter = gen();
console.log(iter.next()); // { value: 1, done: false }
console.log(iter.next()); // { value: 2, done: false }
console.log(iter.next()); // { value: 3, done: false }
console.log(iter.next()); // { value: 100, done: true }

// ë˜ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìˆœíšŒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.
for (const a of gen()) {
	console.log(a);
}
```

### ì œë„¤ë ˆì´í„°ë¥¼ í™œìš©í•œ í™€ìˆ˜ ìƒì„±ê¸° ì˜ˆì œ (odds)

```jsx
function* infinity(i = 0) {
  while (true) {
    yield i++;
  }
}

function* limit(l, iter) {
  for (const a of iter) {
    yield a;
    if (a == l) {
      return;
    }
  }
}

function* odds(l) {
  for (const a of limit(l, infinity(1))) {
    if (a % 2) {
      yield a;
    }
    if (a == l) {
      return;
    }
  }
}

const iter2 = odds(10);
console.log(iter2.next());
console.log(iter2.next());
console.log(iter2.next());
console.log(iter2.next());
console.log(iter2.next());
console.log(iter2.next());
console.log(iter2.next());

for (const a of odds(40)) {
  console.log(a)
}
```

### for of, ì „ê°œ ì—°ì‚°ì, êµ¬ì¡° ë¶„í•´, ë‚˜ë¨¸ì§€ ì—°ì‚°ì

ì œë„¤ë ˆì´í„°ëŠ” `ì´í„°ëŸ¬ë¸”/ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œ` ì„ ì¤€ìˆ˜í•˜ê¸° ë•Œë¬¸ì—

`for of, ì „ê°œ ì—°ì‚°ì, êµ¬ì¡° ë¶„í•´, ë‚˜ë¨¸ì§€ ì—°ì‚°ì` ë“±ê³¼ ê°™ì´ JS ì—ì„œ ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œì„ 

ë”°ë¥´ê³  ìˆëŠ” ë¬¸ë²•ë“¤ê³¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
// ìœ„ ì˜ˆì œì— ì´ì–´ì„œ..

console.log(...odds(10))
console.log([...odds(10), ...odds(20)])

const [head, ...tail] = odds(5);
console.log(head); // 1
console.log(tail); // [3, 5]
```

# map, filter, reduce

## map

### map í•¨ìˆ˜ì— ëŒ€í•´ì„œ

`map` í•¨ìˆ˜ì˜ ê²½ìš° `ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œì„ ë”°ë¥´ëŠ” ê°ì²´` ì™€ `ì¶”ì¶œëŒ€ìƒì— ëŒ€í•œ ë³´ì¡°í•¨ìˆ˜` ë¥¼ 

ë§¤ê°œ ë³€ìˆ˜ë¡œ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ë³´ì¡° í•¨ìˆ˜ë¥¼ í†µí•´ ë¡œì§ì˜ ì¶”ìƒí™”ì™€ ìœ„ì„ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.

```jsx
const products = [
  { name: 'ë°˜íŒ”í‹°', price: 15000 },
  { name: 'ê¸´íŒ”í‹°', price: 20000 },
  { name: 'í•¸ë“œí°ì¼€ì´ìŠ¤', price: 15000 },
  { name: 'í›„ë“œí‹°', price: 30000 },
  { name: 'ë°”ì§€', price: 25000 }
]

const map = (f, iter) => {
  let res = [];
  for (const a of iter) {
    res.push(f(a));
  }

  return res;
}

const price = map(p => p.price, products); 
console.log(price); // [ 15000, 20000, 15000, 30000, 25000 ]
```

### ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œì„ ë”°ë¥¸ map ì˜ ë‹¤í˜•ì„±

ë‹¤ìŒ ì½”ë“œëŠ” ì—ëŸ¬ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```jsx
document.querySelectorAll('*').map(el => el.nodeName)
```

ì´ëŠ” `document.querySelectorAll` ì´ `Array` ë¥¼ ìƒì†ë°›ì€ ê°ì²´ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ë”°ë¼ì„œ `map` í•¨ìˆ˜ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.

ë‹¤ë§Œ ì•ì—ì„œ êµ¬í˜„í•œ `map` í•¨ìˆ˜ëŠ” ì˜ ë™ì‘í•©ë‹ˆë‹¤.

```jsx
map(el => el.nodeName, document.querySelectorAll('*'))
```

ì´ëŠ” `document.querySelectorAll` ì´ ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œì„ ë”°ë¥´ê³  ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì‚¬ìš©ìê°€ ì •ì˜í•œ ì œë„¤ë ˆì´í„° í•¨ìˆ˜ëŠ” ì–´ë–»ê²Œ ë ê¹Œìš”?

```jsx
function* gen() {
  yield 2;
  yield 3;
  yield 4;
}

console.log(map(a => a * a, gen())) // [4, 9, 16]
```

ë§ˆì°¬ê°€ì§€ë¡œ ì œë„¤ë ˆì´í„°ëŠ” ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ë™ì¼í•˜ê²Œ ì˜ ë™ì‘í•©ë‹ˆë‹¤.

ì¶”ê°€ì ìœ¼ë¡œ ES6 ì— ìƒˆë¡­ê²Œ ì¶”ê°€ëœ ìë£Œ êµ¬ì¡°ì¸ `Map` ë˜í•œ ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œì„ ë”°ë¦…ë‹ˆë‹¤.

```jsx
const m = new Map();
m.set('a', 10);
m.set('b', 20);

console.log(map(([k, v]) => [k, v * 2], m)); // [ [ 'a', 20 ], [ 'b', 40 ] ]
```

## filter

`filter` ëŠ” íŠ¹ì • ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ìš”ì†Œë§Œ ê±¸ëŸ¬ë‚´ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

```jsx
const filter = (f, iter) => {
  const res = [];

  for (const a of iter) {
    if (f(a)) {
      res.push(a);
    }
  }

  return res;
}

console.log(filter(p => p.price < 20000, products)); // [ { name: 'ë°˜íŒ”í‹°', price: 15000 }, { name: 'í•¸ë“œí°ì¼€ì´ìŠ¤', price: 15000 } ]
```

## reduce

`reduce` ëŠ” ì´í„°ëŸ¬ë¸”ì˜ ê°’ì„ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ì¶•ì•½í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

ì´ í•¨ìˆ˜ ë˜í•œ ë³´ì¡° í•¨ìˆ˜ë¥¼ í†µí•´ ë‚´ë¶€ì˜ ë‹¤í˜•ì„±ì„ ì˜ ì§€ì›í•˜ëŠ” í˜•íƒœì…ë‹ˆë‹¤.

```jsx
const nums = [1, 2, 3, 4, 5];

const reduce = (f, acc, iter) => {
  if (!iter) {
    /**
     * ì´ˆê¸°ê°’ ìƒëµí•˜ëŠ” ë°©ì‹ ì²˜ë¦¬
     */
    iter = acc[Symbol.iterator]();
    acc = iter.next().value;
  }

  for (const a of iter) {
    acc = f(acc, a);
  }

  return acc;
};

const add = (a, b) => a + b;

console.log(reduce(add, 0, [1, 2, 3, 4, 5])); // 15
console.log(reduce(add, [1, 2, 3, 4, 5])); // 15 
```


# Functor, Applicative, Monad

## Functor

`Functor` ë€ ë°•ì‹±ëœ ê°’ì—ì„œ ê°’ì„ ëº€ í›„ í•´ë‹¹ ê°’ì— íŠ¹ì • í•¨ìˆ˜ë¥¼ ì ìš©í•´ íƒ€ì…ê³¼ ê°’ì„ ë³€ê²½í•˜ê³ 

ë³€ê²½ëœ ê°’ì„ ë‹¤ì‹œ ë°•ì‹±í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ëŒ€ë¶€ë¶„ì˜ ëª¨ë˜ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë“¤ì˜ `List í˜¹ì€ Array` ëŠ” `Functor` ì˜ ê°œë…ì„ ê°€ì§‘ë‹ˆë‹¤.

(ì¦‰ `map` ì„ ì§€ì›í•©ë‹ˆë‹¤.)

![1](https://user-images.githubusercontent.com/37819666/120923269-96498b00-c708-11eb-898c-be9b000d0124.png)


ë°•ì‹±ëœ ê°’ì´ë€ ë¬´ì—‡ì¸ê°€ìš”?

`Array` ì™€ ê°™ì´ ê°’ì„ ê°ì‹¼ íƒ€ì…ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

### Javascript ì—ì„œ ì ìš© ì˜ˆì‹œ

ì•ì„œ ë§í–ˆë“¯ì´ `Array` ëŠ” `map` ì„ êµ¬í˜„í•œ `Functor` ì…ë‹ˆë‹¤.

![2](https://user-images.githubusercontent.com/37819666/120923268-96498b00-c708-11eb-83cb-3aecb6c390e7.png)


```jsx
var plus3AndPrintValue = function(val) {
  var result = val + 3;
  console.log(result);
  return result;
}

[2].map(plus3AndPrintValue);
// '5' 

[].map(plus3AndPrintValue);
// nothing
```

## Applicative

`Applicative` ì—ì„œëŠ” ê°’ ë¿ë§Œ ì•„ë‹ˆë¼ ì ìš©í•  í•¨ìˆ˜ë„ ë˜í•‘ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

![3](https://user-images.githubusercontent.com/37819666/120923267-95b0f480-c708-11eb-8012-9cb32bbf3b6d.png)


JS ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `Applicative` ë¥¼ ë‚´ì¥í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.

ë”°ë¼ì„œ ì´ì™€ ë™ì¼í•œ ë™ì‘ì„ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•˜ëŠ”ë°

ì—¬ê¸°ì„œ ë˜í•‘ëœ í•¨ìˆ˜ëŠ” `ì»¤ë§ í•¨ìˆ˜` ë¥¼ í†µí•´ì„œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
//Wrapped values
var wrapped2 = [2];
var wrapped3 = [3];

//If add can be curried
var wrappedPlus3 = wrapped3.map(add);

Array.prototype.ap = function(wrappedVal) {
  if (this[0] !== undefined) {
    return wrappedVal.map(this[0]); //Assuem this[0] is a function
  } else {
    return [];
  }
}

wrappedPlus3.ap(wrapped2);
//=> [5]
```

ë§Œì•½ ì—¬ëŸ¬ê°œì˜ ë˜í•‘ëœ í•¨ìˆ˜ê°€ ì¡´ì¬í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ `ap` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

![4](https://user-images.githubusercontent.com/37819666/120923264-947fc780-c708-11eb-9716-8d6624bb9446.png)


```jsx
Array.prototype.ap = function(wrappedVals) {
  var results = [];
  for (var i = 0; this.length; i++) {
    results.push(wrappedVals.map(this[i])); //this[i] are pure functions without side effects
  }
  return results;
}
```

## Monad

`Monad` ëŠ” `ë˜í•‘ëœ ê°’ì— ë˜í•‘ëœ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì ìš©í•˜ëŠ” ê²ƒ` ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì´ëŠ” `flatMap` ì´ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ì„œ êµ¬í˜„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

![5](https://user-images.githubusercontent.com/37819666/120923263-921d6d80-c708-11eb-9bec-2af4de9dd1b0.png)


`flatMap` ì€ ë‹¤ìŒê³¼ ê°™ì´ ë‚´ë¶€ ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```jsx
// Array ì—ëŠ” flatMap ì´ ì´ë¯¸ êµ¬í˜„ë˜ì–´ìˆì§€ë§Œ ë™ì‘ ë°©ì‹ì„ ë³´ê¸° ìœ„í•´ ì´ë ‡ê²Œ ì¶”ê°€í•¨

Array.prototype.flatMap = function(lambda) { 
  return [].concat.apply([], this.map(lambda)); 
};
```

ì´ì œ ë˜í•‘ëœ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ `half` ë¥¼ ì •ì˜í•˜ê² ìŠµë‹ˆë‹¤.

í•´ë‹¹ í•¨ìˆ˜ëŠ” ì§ìˆ˜ì¼ ê²½ìš°ì—ë§Œ ë°˜ìœ¼ë¡œ ë‚˜ëˆˆ ê°’ì„ ë°°ì—´ì— ë‹´ê³  ê·¸ ì™¸ì—ëŠ” ë¹ˆ ë°°ì—´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```jsx
var half = function(val) {
  return val % 2 == 0 ? [val / 2] : [];
}
```

ìœ„ í•¨ìˆ˜ëŠ” ì¸ìë¡œ ë˜í•‘ë˜ì§€ ì•Šì€ ê°’ì„ ë°›ê¸° ë•Œë¬¸ì— `ë˜í•‘ëœ ê°’ì„ ì¶”ì¶œí•˜ëŠ” ê³¼ì •` ì´ í•„ìš”í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ ì•ì„œ êµ¬í˜„í•œ `flatMap` ì„ ì´ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

(ì‚¬ì‹¤ ì˜ˆì œëŠ” `map` ê³¼ ë™ì¼í•˜ì§€ë§Œ `flatMap` ì´ ì¢€ ë” ìœ ìš©í•˜ë‹¤ê³  í•©ë‹ˆë‹¤.)

```jsx
[3].flatMap(half)
//[]
[4].flatMap(half)
//[2]
[].flatMap(half)
//[]
[20].flatMap(half).flatMap(half).flatMap(half);
// => []
```

ì™œ ë˜í•‘ëœ ê°’ì„ ë°˜í™˜í•˜ë„ë¡ í•˜ëŠ” ê²ƒì¼ê¹Œ?

ì´ëŠ” ì ì¬ì ìœ¼ë¡œ ë¹ˆ ê°’ì„ ë‚˜íƒ€ë‚´ê¸°ì— ì¢‹ê³  ë¹ˆ ê°’ì„ ëŒ€ìƒìœ¼ë¡œ 
ì˜ˆìƒì¹˜ ëª»í•œ ì—°ì‡„ì ì¸ í˜¸ì¶œì„ í•˜ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë¼ê³  í•©ë‹ˆë‹¤. ğŸ˜„

## Promise ê°ì²´ëŠ” ë¬´ì—‡ì¼ê¹Œ?

íŠ¹ì • ë¸”ë¡œê·¸ì—ì„œ `Promise` ëŠ” `Monad` ë¼ê³  í•˜ëŠ” ê³³ì´ ìˆëŠ”ë° ì´ëŠ” ì˜ëª»ëœ ì •ë³´ì…ë‹ˆë‹¤.

`Promise` ëŠ” `Functor, Applicative, Monad` ì…‹ ì¤‘ ì–´ëŠê²ƒì—ë„ ì†í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•©ë‹ˆë‹¤.

[Are Promises Monads Functor or Applicative (2017-20-12)](https://hgiasac.github.io/posts/2017-20-12-Are-Promises-Monads-Functor-or-Applicative.html)

## ìš”ì•½í•˜ë©´..

- functor:Â `map` ì„ ì´ìš©í•˜ì—¬ ìƒì ì† ê°’ì— í•¨ìˆ˜ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.
- applicative:Â `ap` ë¥¼ ì´ìš©í•˜ì—¬ ìƒì ì† í•¨ìˆ˜ë¥¼ ìƒì ì† ê°’ì— ì ìš©í•  ìˆ˜ ìˆë‹¤.
- monad:Â `flatMap` ì„  ì´ìš©í•˜ì—¬ ìƒì ì† ê°’ì— í•¨ìˆ˜ë¥¼ ì ìš©í•˜ê³  ê°’ì´ ë‹´ê¸´ ìƒìë¥¼ ë°˜í™˜í•œë‹¤.

## ì°¸ê³  ìë£Œ

[Functor(í‘í„°) with Kotlin](https://medium.com/@lazysoul/functor-%ED%8E%91%ED%84%B0-7d5819a87b91)

[Javascript Functor, Applicative, Monads in pictures](https://medium.com/@tzehsiang/javascript-functor-applicative-monads-in-pictures-b567c6415221)

[Array.prototype.flatMap() - JavaScript | MDN](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap)

[Are Promises Monads Functor or Applicative (2017-20-12)](https://hgiasac.github.io/posts/2017-20-12-Are-Promises-Monads-Functor-or-Applicative.html)
