# ì§€ì—°ì„± Part 1 (~ L.filter)

## range ì™€ ëŠê¸‹í•œ L.range

### range í•¨ìˆ˜ëž€?

`range` í•¨ìˆ˜ëŠ” ìˆ«ìžë¥¼ í•˜ë‚˜ ë°›ê³  ìˆ«ìžì˜ í¬ê¸°ë§Œí•œ ë°°ì—´ì„ ë§Œë“¤ì–´ì„œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ìž…ë‹ˆë‹¤.

```jsx
const range = l => {
  let i = -1;
  let res = [];

  while (++i < l) {
    res.push(i)
  }

  return res;
};

console.log(range(5)); // [0, 1, 2, 3, 4]

console.log(range(2)); // [0, 1]
```

ì´ëŠ” ì•žì„œ êµ¬í˜„í–ˆë˜ `reduce` í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ë°°ì—´ì˜ ëª¨ë“  ì›ì†Œì˜ í•©ì„ êµ¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ

ì‚¬ìš©í•  ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤.

```jsx
import * as FX from './fx.js';

const add = (a, b) => a + b;

const range = l => {
  let i = -1;
  let res = [];

  while (++i < l) {
    res.push(i)
  }

  return res;
};

const list = range(4);

console.log(FX.reduce(add, list))
```

### ëŠê¸‹í•œ range ëž€? (Lazy range)

ì•žì„œ êµ¬í˜„í•œ `range` í•¨ìˆ˜ë¥¼ `L` ì´ë¼ëŠ” ê°ì²´ì˜ ë©”ì„œë“œë¡œ í¬í•¨ ì‹œí‚¤ê³ 

í•´ë‹¹ í•¨ìˆ˜ë¥¼ `generator` ë¡œ ë³€ê²½í•´ì„œ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.

```jsx
import * as FX from './fx.js';

const add = (a, b) => a + b;

const L = {};

L.range = function* (l) {
  let i = -1;

  while (++i < l) {
    yield i;
  }
};

const list = L.range(4); 
console.log(list); // iterator!
console.log(FX.reduce(add, list));
```

ì´ ê²½ìš° `reduce` ì‹œì— ë™ì¼í•œ ë™ìž‘ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìžˆëŠ”ë°, 

ì´ëŠ” `reduce` í•¨ìˆ˜ê°€ ì´í„°ëŸ¬ë¸”ì„ ë°›ì„ ìˆ˜ ìžˆë„ë¡ êµ¬í˜„ë˜ì–´ ìžˆê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

ì¦‰, ì´ëŠ” ë°°ì—´ê³¼ ì´í„°ë ˆì´í„° ëª¨ë‘ `ì´í„°ëŸ¬ë¸”` í•˜ê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•œ ê²ƒìž…ë‹ˆë‹¤.

**rangeì™€ L.range ì˜ ì°¨ì´ì ì€?**

`range` ì˜ ê²½ìš° í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ ì¦‰ì‹œ ë°°ì—´ë¡œ í‰ê°€ë˜ì–´ ë°˜í™˜ë©ë‹ˆë‹¤.

`L.range` ì˜ ê²½ìš°ì—ëŠ” í‰ê°€ë˜ëŠ” ì‹œì ì´ ë‹¤ë¥´ë©° `next` í•¨ìˆ˜ë¥¼ í†µí•´ í˜¸ì¶œë ë•Œë§Œ

í‰ê°€ë˜ì–´ í•„ìš”í•œ ê°’ì„ ê°€ì ¸ì˜¤ê²Œ ë©ë‹ˆë‹¤.

ì¦‰ `L.range` ëŠ” ë°°ì—´ í˜•íƒœë¡œ ì¡´ìž¬í•˜ì§€ ì•Šë‹¤ê°€ í•„ìš”í•œ ì‹œì ì— ë°°ì—´ì²˜ëŸ¼ êº¼ë‚´ì„œ ì“¸ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

- Array ì˜ ê²½ìš°

    Array ë§Œë“¤ê¸° â†’ ì´í„°ë ˆì´í„° ë§Œë“¤ê¸° â†’ next í˜¸ì¶œí•˜ë©° ìˆœíšŒ

- L.range ì˜ ê²½ìš°

    Iterator ë§Œë“¤ê¸° â†’ Iteratorê°€ ìžê¸°ìžì‹ ì„ ë°˜í™˜ â†’ next í˜¸ì¶œí•˜ë©° ìˆœíšŒ

â†’ ì¢€ ë” íš¨ìœ¨ì ì´ë¼ëŠ” ì˜ë¯¸!

ìœ„ ì‚¬ì‹¤ì„ ì§ì ‘ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ê²€ì¦í•œ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```jsx
function test(name, time, f) {
  console.time(name);

  while (time--) f();

  console.timeEnd(name);
}

test('range', 10, () => FX.reduce(add, range(1000000))); // range: 376.473ms
test('L.range', 10, () => FX.reduce(add, L.range(1000000))); // L.range: 236.982ms
```

## take í•¨ìˆ˜

`take` í•¨ìˆ˜ëŠ” `limit` ê°’ê³¼ `iterable` ê°’ì„ ë°›ì•„ì„œ ìµœëŒ€ `limit` ë§Œí¼ ìž˜ë¼ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

```jsx
const take = (l, iter) => {
  let res = [];

  for (const a of iter) {
    res.push(a);

    if (res.length == l) {
      return res;
    }
  }

  return res;
}

console.log(range(10)); // [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 ]
console.log(take(5, range(10))); // [ 0, 1, 2, 3, 4 ]
console.log(take(5, L.range(10))); // [ 0, 1, 2, 3, 4 ]
```

`L.range`  ê°™ì´ ì§€ì—°ì„±ì„ ê°€ì§€ëŠ” ê°’ì„ ì´í„°ë ˆì´í„°ë¡œ êµ¬í˜„í•˜ê²Œ ë˜ë©´ ì „í˜€ ë‹¤ë¥¸ í•¨ìˆ˜ê°€

ì´í„°ëŸ¬ë¸” í”„ë¡œí† ì½œë§Œ ë”°ë¥¸ë‹¤ë©´ ì „ë¶€ ì¡°í•©ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ê°•ì ì´ë¼ê³  í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ðŸ˜„

íš¨ìœ¨ì„± ì¸¡ë©´ì—ì„œë„ `range` ì˜ ê²½ìš° ì¸ìžë¡œ ë°›ì€ í¬ê¸° ë§Œí¼ì˜ ë°°ì—´ì„ ë§Œë“¤ê³  ê·¸ ì¤‘ `limit` ë§Œí¼

ìž˜ë¼ì„œ ì“°ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— `L.range` ë³´ë‹¤ ëŠë¦¬ê²Œ ë™ìž‘í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

### take ë¥¼ ì´ìš©í•œ ì§€ì—°ì„±ì˜ íš¨ìœ¨ì„± ë¹„êµ

```jsx
console.time('');
console.log(take(5, range(1000000))); // 18.510ms
console.timeEnd('');

console.time('');
console.log(take(5, L.range(1000000))); // 0.089ms
console.timeEnd('');
```

### curry ë¥¼ ì´ìš©í•´ì„œ ì¢€ ë” ë³´ê¸°ì¢‹ê²Œ ë§Œë“¤ê¸°

```jsx
const take = FX.curry((l, iter) => {
  let res = [];

  for (const a of iter) {
    res.push(a);

    if (res.length == l) {
      return res;
    }
  }

  return res;
});

console.time('');
FX.go(
  range(1000000),
  take(5),
  FX.reduce(add),
  console.log
);
console.timeEnd(''); // 26.483ms

console.time('');
FX.go(
  L.range(1000000),
  take(5),
  FX.reduce(add),
  console.log
);
console.timeEnd(''); // 0.100ms
```

## ì§€ì—° í‰ê°€

`ì§€ì—° í‰ê°€` ëŠ” ìµœëŒ€í•œ ê²Œìœ¼ë¥´ê²Œ, ì˜ë¦¬í•˜ê²Œ í‰ê°€í•˜ëŠ” ê²ƒì´ë¼ê³  í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ê°€ìž¥ í•„ìš”í• ë•Œê¹Œì§€ í‰ê°€ë¥¼ ë¯¸ë£¨ë‹¤ê°€ í•„ìš”í•´ì§€ë§Œ ê°’ì„ ë§Œë“¤ì–´ê°€ëŠ” ê¸°ë²•ìž…ë‹ˆë‹¤.

ì•žì„  `L.range` ì™€ ê°™ì´ í° í¬ê¸°ì˜ ë°°ì—´ì„ ë§Œë“¤ì–´ ë†“ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í•„ìš”í•´ì§ˆë•Œ

ë°°ì—´ì„ êµ¬ì„±í•˜ëŠ” ê°’ë“¤ì„ ë§Œë“¤ì–´ê°€ëŠ” ê²ƒìž…ë‹ˆë‹¤.

## ê·¸ ì™¸ Lazy í•¨ìˆ˜ë“¤

### L.map

```jsx
const L = {};

L.map = function* (f, iter) {
  for (const a of iter) {
    yield f(a);
  }
}

const it = L.map(a => a + 10, [1, 2, 3]);

console.log(it.next()); // { value: 11, done: false }
console.log(it.next()); // { value: 12, done: false }
console.log(it.next()); // { value: 13, done: false }
```

### L.filter

```jsx
L.filter = function* (f, iter) {
  for (const a of iter) {
    if (f(a)) {
      yield a;
    }
  }
}

const it = L.filter(a => a % 2, [1, 2, 3, 4]);
console.log(it.next()); // { value: 1, done: false }
console.log(it.next()); // { value: 3, done: false }
console.log(it.next()); // { value: undefined, done: true }
```
